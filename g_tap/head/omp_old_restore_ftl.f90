!        Generated by TAPENADE     (INRIA, Ecuador team)
!  tapenade 3.x
!
!  Differentiation of omp_old_restore in forward (tangent) mode:
!   variations   of useful results: *temp *head *conc *pres
!   with respect to varying inputs: *concold *temp *headold *head
!                *tempold *presold *conc *pres
!   Plus diff mem management of: concold:in temp:in headold:in
!                head:in tempold:in presold:in conc:in pres:in
!>    @brief restores an old state/version
!>    @param[in] level level number (which old version)
!>    @param[in] ismpl local sample index
SUBROUTINE g_OMP_OLD_RESTORE(level, ismpl)
  USE ARRAYS

  USE g_ARRAYS

  USE MOD_GENRL
  USE MOD_CONC
  IMPLICIT NONE
  INTEGER :: ismpl
  INTEGER :: i, j, k, l
  INTEGER :: level, tpos, tanz
  INTRINSIC ABS, MAX
  INTEGER :: abs0
  INTEGER :: abs1
  INTEGER :: abs2
  INTEGER :: abs3
  INTEGER :: max1
  INTEGER :: max2
  INTEGER :: max3
  INTEGER :: max4
  CALL OMP_PART(i0*j0*k0, tpos, tanz)
  CALL IJK_M(tpos, i, j, k)
  IF (ismpl .GE. 0.) THEN
    abs0 = ismpl
  ELSE
    abs0 = -ismpl
  END IF
  IF (1 .LT. ismpl) THEN
    max1 = ismpl
  ELSE
    max1 = 1
  END IF
!     save state (before)
  CALL g_DCOPY(tanz, headold(tpos, level, abs0), g_headold(tpos, &
&          level, abs0), 1, head(i, j, k, max1), g_head(i, j, k, max1)&
&          , 1)
  IF (ismpl .GE. 0.) THEN
    abs1 = ismpl
  ELSE
    abs1 = -ismpl
  END IF
  IF (1 .LT. ismpl) THEN
    max2 = ismpl
  ELSE
    max2 = 1
  END IF
  CALL g_DCOPY(tanz, tempold(tpos, level, abs1), g_tempold(tpos, &
&          level, abs1), 1, temp(i, j, k, max2), g_temp(i, j, k, max2)&
&          , 1)
  IF (ismpl .GE. 0.) THEN
    abs2 = ismpl
  ELSE
    abs2 = -ismpl
  END IF
  IF (1 .LT. ismpl) THEN
    max3 = ismpl
  ELSE
    max3 = 1
  END IF
  CALL g_DCOPY(tanz, presold(tpos, level, abs2), g_presold(tpos, &
&          level, abs2), 1, pres(i, j, k, max3), g_pres(i, j, k, max3)&
&          , 1)
  DO l=1,ntrans
    IF (ismpl .GE. 0.) THEN
      abs3 = ismpl
    ELSE
      abs3 = -ismpl
    END IF
    IF (1 .LT. ismpl) THEN
      max4 = ismpl
    ELSE
      max4 = 1
    END IF
    CALL g_DCOPY(tanz, concold(tpos, l, level, abs3), g_concold(tpos&
&            , l, level, abs3), 1, conc(i, j, k, l, max4), g_conc(i, j&
&            , k, l, max4), 1)
  END DO
!
  RETURN
END SUBROUTINE g_OMP_OLD_RESTORE

