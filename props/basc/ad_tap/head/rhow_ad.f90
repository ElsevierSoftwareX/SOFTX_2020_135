!        Generated by TAPENADE     (INRIA, Ecuador team)
!  tapenade 3.x
!
!  Differentiation of rhow in reverse (adjoint) mode (with options noISIZE i8):
!   gradient     of useful results: p t rhow
!   with respect to varying inputs: p t
! MIT License
!
! Copyright (c) 2020 SHEMAT-Suite
!
! Permission is hereby granted, free of charge, to any person obtaining a copy
! of this software and associated documentation files (the "Software"), to deal
! in the Software without restriction, including without limitation the rights
! to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
! copies of the Software, and to permit persons to whom the Software is
! furnished to do so, subject to the following conditions:
!
! The above copyright notice and this permission notice shall be included in all
! copies or substantial portions of the Software.
!
! THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
! IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
! FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
! AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
! LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
! OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
! SOFTWARE.
!> @brief rhow calculates the density of pure water [kg/m3]
!> @param[in] p pressure [MPa]
!> @param[in] t temperature [degC]
!> @return rhow density of pure water [kg/m3]
!> @details
!> rhow(i,j,k,ismpl) calculates the density in (in kg/m^3) of pure
!> water, given temperature (t, in degC), and pressure (p,in Pa)\n \n
!>
!> Source: \n
!>
!> Magri, F. (2005), Mechanismus und Fluiddynamik der
!> Salzwasserzirkulation im Norddeutschen Becken: Ergebnisse
!> thermohaliner numerischer Simulationen, Doktorarbeit,
!> Geoforschungszentrum Potsdam \n \n
!>
!> Specifically: Equation (2.12) and Table 2-1
SUBROUTINE RHOW_AD0(p, p_ad, t, t_ad, rhow_ad)
  IMPLICIT NONE
! Local temperature (degC)
  DOUBLE PRECISION, INTENT(IN) :: t
  DOUBLE PRECISION :: t_ad
! Local pressure (MPa)
  DOUBLE PRECISION, INTENT(IN) :: p
  DOUBLE PRECISION :: p_ad
! Pressure in kPa
  DOUBLE PRECISION :: pk
  DOUBLE PRECISION :: pk_ad
! Monomials in pressure and temperature
  DOUBLE PRECISION :: pk2, t2, t4, t6
  DOUBLE PRECISION :: pk2_ad, t2_ad, t4_ad, t6_ad
! Coefficients from Magri2005 Equation (2.12)
  DOUBLE PRECISION :: a, b, c, d, e, f, g
  DOUBLE PRECISION :: a_ad, b_ad, c_ad, d_ad, e_ad, f_ad, g_ad
! Coefficients from Magri2005 Table 2-1
  DOUBLE PRECISION, PARAMETER :: a0=9.99792877961606d02
  DOUBLE PRECISION, PARAMETER :: a1=5.07605113140940d-04
  DOUBLE PRECISION, PARAMETER :: a2=-5.28425478164183d-10
  DOUBLE PRECISION, PARAMETER :: b0=5.13864847162196d-02
  DOUBLE PRECISION, PARAMETER :: b1=-3.61991396354483d-06
  DOUBLE PRECISION, PARAMETER :: b2=7.97204102509724d-12
  DOUBLE PRECISION, PARAMETER :: c0=-7.53557031774437d-03
  DOUBLE PRECISION, PARAMETER :: c1=6.32712093275576d-08
  DOUBLE PRECISION, PARAMETER :: c2=-1.66203631393248d-13
  DOUBLE PRECISION, PARAMETER :: d0=4.60380647957350d-05
  DOUBLE PRECISION, PARAMETER :: d1=-5.61299059722121d-10
  DOUBLE PRECISION, PARAMETER :: d2=1.80924436489400d-15
  DOUBLE PRECISION, PARAMETER :: e0=-2.26651454175013d-07
  DOUBLE PRECISION, PARAMETER :: e1=3.36874416675978d-12
  DOUBLE PRECISION, PARAMETER :: e2=-1.30352149261326d-17
  DOUBLE PRECISION, PARAMETER :: f0=6.14889851856743d-10
  DOUBLE PRECISION, PARAMETER :: f1=-1.06165223196756d-14
  DOUBLE PRECISION, PARAMETER :: f2=4.75014903737416d-20
  DOUBLE PRECISION, PARAMETER :: g0=-7.39221950969522d-13
  DOUBLE PRECISION, PARAMETER :: g1=1.42790422913922d-17
  DOUBLE PRECISION, PARAMETER :: g2=-7.13130230531541d-23
  DOUBLE PRECISION :: rhow
  DOUBLE PRECISION :: rhow_ad
! Unit [kPa] is needed after Magri(2005); the forwarded p is in [MPa]
  pk = p*1000
! Monomials in pressure and temperature
  pk2 = pk*pk
  t2 = t*t
  t4 = t2*t2
  t6 = t4*t2
! Coefficients from Magri2005, Equation (2.12)
  b = b0 + b1*pk + b2*pk2
  c = c0 + c1*pk + c2*pk2
  d = d0 + d1*pk + d2*pk2
  e = e0 + e1*pk + e2*pk2
  f = f0 + f1*pk + f2*pk2
  g = g0 + g1*pk + g2*pk2
! Water density [kg/m3]
  t6_ad = g*rhow_ad
  t4_ad = (e+f*t)*rhow_ad + t2*t6_ad
  t2_ad = (c+d*t)*rhow_ad + t4*t6_ad + 2*t2*t4_ad
  a_ad = rhow_ad
  b_ad = t*rhow_ad
  t_ad = t_ad + (b+d*t2+f*t4)*rhow_ad + 2*t*t2_ad
  c_ad = t2*rhow_ad
  d_ad = t2*t*rhow_ad
  e_ad = t4*rhow_ad
  f_ad = t4*t*rhow_ad
  g_ad = t6*rhow_ad
  pk2_ad = g2*g_ad + f2*f_ad + e2*e_ad + d2*d_ad + c2*c_ad + b2*b_ad + &
&   a2*a_ad
  pk_ad = g1*g_ad + f1*f_ad + e1*e_ad + d1*d_ad + c1*c_ad + b1*b_ad + a1&
&   *a_ad + 2*pk*pk2_ad
  p_ad = p_ad + 1000*pk_ad
END SUBROUTINE RHOW_AD0

