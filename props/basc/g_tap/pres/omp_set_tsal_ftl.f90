!        Generated by TAPENADE     (INRIA, Ecuador team)
!  tapenade 3.x
!
!  Differentiation of omp_set_tsal in forward (tangent) mode:
!   variations   of useful results: *tsal
!   with respect to varying inputs: *tsal *conc
!   Plus diff mem management of: tsal:in conc:in
!>    @brief calculate total salinity
!>    @param[in] ismpl local sample index
!>    @details
!>calculate total salinity\n
SUBROUTINE g_OMP_SET_TSAL(ismpl)
  USE ARRAYS

  USE g_ARRAYS

  USE MOD_CONC
  USE MOD_GENRL
  USE MOD_GENRLC
  USE MOD_LINFOS
  IMPLICIT NONE
  INTEGER :: ismpl
  INTEGER :: i, j, k
  INTEGER :: species
  DOUBLE PRECISION :: summ, fac
  DOUBLE PRECISION :: g_summ
  EXTERNAL DUMMY
!$OMP master
  IF (linfos(3) .GE. 2) WRITE(*, '(1A)') '  ... setting total salinity'
!$OMP end master
!$OMP do schedule(static) collapse(3)
  DO k=1,k0
    DO j=1,j0
      DO i=1,i0
        summ = 0.d0
        g_summ = 0.D0
        DO species=1,ntrans
          fac = mmas_c(species)/mmas_nacl
          g_summ = g_summ + fac*g_conc(i, j, k, species, ismpl)
          summ = summ + fac*conc(i, j, k, species, ismpl)
        END DO
        g_tsal(i, j, k, ismpl) = g_summ
        tsal(i, j, k, ismpl) = summ
      END DO
    END DO
  END DO
!$OMP end do nowait
  RETURN
END SUBROUTINE g_OMP_SET_TSAL

